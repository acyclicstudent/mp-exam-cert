{"version":3,"sources":["../src/app.js"],"names":["process","env","NODE_ENV","require","config","mercadopago","configure","access_token","ACCESS_TOKEN","integrator_id","app","use","bodyParser","json","express","__dirname","get","req","res","send","data","product","filter","item","id","query","length","sendStatus","post","body","error","message","preference","payer","name","surname","email","phone","area_code","number","parseInt","address","street_name","street","street_number","hnumber","zip_code","zip","external_reference","payment_methods","excluded_payment_methods","excluded_payment_types","installments","items","title","quantity","picture_url","URL_BASE","img","unit_price","price","currency_id","category_id","description","auto_return","back_urls","success","failure","pending","notification_url","preferences","create","then","response","console","log","url","init_point","err","listen"],"mappings":"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","sourcesContent":["if (process.env.NODE_ENV != 'production')\r\n    require('dotenv').config();\r\nimport React from 'react';\r\nimport express from 'express';\r\nimport { renderToString } from 'react-dom/server';\r\nimport Layout from './Layout';\r\nimport Detail from './Detail';\r\nimport Home from './Home';\r\nimport bodyParser from 'body-parser';\r\nimport mercadopago from 'mercadopago';\r\nimport Failure from './Failure';\r\nimport Success from './Success';\r\nimport Pending from './Pending';\r\n\r\nmercadopago.configure({\r\n    access_token: process.env.ACCESS_TOKEN,\r\n    integrator_id: 'dev_24c65fb163bf11ea96500242ac130004'\r\n});\r\n\r\nconst app = express();\r\n\r\napp.use(bodyParser.json());\r\napp.use(express.static('assets'));\r\napp.use('/assets', express.static(__dirname + '/assets'))\r\n\r\n// Inicio de la tienda\r\napp.get('/', (req, res) => {\r\n    res.send(\r\n        renderToString(\r\n            <Layout\r\n                title=\"Inicio | Tienda e-commerce\"\r\n                view=\"home\"\r\n            >\r\n                <Home data={data} />\r\n            </Layout>\r\n        )\r\n    );\r\n});\r\n\r\n// Despliegue de item individual\r\napp.get('/details', (req, res) => {\r\n    const product = data.filter((item) => item.id == req.query?.id);\r\n    if (product.length == 0)\r\n        return res.sendStatus(404);\r\n    res.send(\r\n        renderToString(\r\n            <Layout\r\n                title=\"Producto | Tienda e-commerce\"\r\n                view=\"item\"\r\n            >\r\n                <Detail\r\n                    data={product[0]}\r\n                />\r\n            </Layout>\r\n        )\r\n    );\r\n});\r\n\r\n// Back urls\r\napp.get('/success', (req, res) => {\r\n    res.send(\r\n        renderToString(\r\n            <Layout\r\n                title=\"Completado | Tienda e-commerce\"\r\n                view=\"\"\r\n            >\r\n                <Success data={req.query}/>\r\n            </Layout>\r\n        )\r\n    );\r\n});\r\n\r\napp.get('/pending', (req, res) => {\r\n    res.send(\r\n        renderToString(\r\n            <Layout\r\n                title=\"Pendiente | Tienda e-commerce\"\r\n                view=\"\"\r\n            >\r\n                <Pending />\r\n            </Layout>\r\n        )\r\n    );\r\n});\r\n\r\napp.get('/failure', (req, res) => {\r\n    res.send(\r\n        renderToString(\r\n            <Layout\r\n                title=\"Fallo al pagar | Tienda e-commerce\"\r\n                view=\"\"\r\n            >\r\n                <Failure />\r\n            </Layout>\r\n        )\r\n    );\r\n})\r\n\r\napp.post('/payment', (req, res) => {\r\n    const product = data.filter((item) => item.id == req.body.id);\r\n    if (product.length == 0)\r\n        return res.send({ error: true, message: 'PRODUCT_NOT_FOUND' });\r\n    const preference = {\r\n        payer: {\r\n            name: req.body.name,\r\n            surname: req.body.surname,\r\n            email: req.body.email,\r\n            phone: {\r\n                area_code: '52',\r\n                number: parseInt(req.body.number)\r\n            },\r\n            address: {\r\n                street_name: req.body.street,\r\n                street_number: parseInt(req.body.hnumber),\r\n                zip_code: req.body.zip\r\n            }\r\n        },\r\n        external_reference: 'axel_07_avila@hotmail.com',\r\n        payment_methods: {\r\n            excluded_payment_methods: [{ id: 'amex' }],\r\n            excluded_payment_types: [{ id: 'atm' }],\r\n            installments: 6\r\n        },\r\n        items: [\r\n            {\r\n                id: '1234',\r\n                title: product[0].name,\r\n                quantity: 1,\r\n                picture_url: process.env.URL_BASE + product[0].img,\r\n                unit_price: product[0].price,\r\n                currency_id: 'MXN',\r\n                category_id: 'phones',\r\n                description: product[0].description\r\n            }\r\n        ],\r\n        auto_return: 'approved',\r\n        back_urls: {\r\n            success: process.env.URL_BASE + '/success',\r\n            failure: process.env.URL_BASE + '/failure',\r\n            pending: process.env.URL_BASE + '/pending'\r\n        },\r\n        notification_url: process.env.URL_BASE + '/notifications'\r\n    };\r\n    mercadopago.preferences.create(preference)\r\n    .then(response => {\r\n        console.log(response);\r\n        res.send({ error: false, url: response.response.init_point });\r\n    })\r\n    .catch(err => {\r\n        console.log(err);\r\n        res.send({ error: true, message: 'Error con mercado pago' })\r\n    });\r\n});\r\n\r\n// Webhooks\r\napp.post('/notifications', (req, res) => {\r\n    console.log(req.body);\r\n    res.sendStatus(200);\r\n});\r\n\r\napp.listen(3000, () => {\r\n    console.log('Server on port 3000');\r\n});\r\n\r\n// Test data\r\nconst data = [\r\n    {\r\n        id: 1,\r\n        name: \"Samsung Galaxy S9\",\r\n        img: \"/assets/img/galaxy-s9.jpg\",\r\n        description: \"Dispositivo móvil de Tienda e-commerce​\",\r\n        price: 15000\r\n    },\r\n    {\r\n        id: 2,\r\n        name: \"LG G6\",\r\n        img: \"/assets/img/l6g6.jpg\",\r\n        description: \"Dispositivo móvil de Tienda e-commerce​\",\r\n        price: 10000\r\n    },\r\n    {\r\n        id: 3,\r\n        name: \"iPhone 8\",\r\n        img: \"/assets/img/iphone.jpg\",\r\n        description: \"Dispositivo móvil de Tienda e-commerce​\",\r\n        price: 16000\r\n    },\r\n    {\r\n        id: 4,\r\n        name: \"Motorola G5\",\r\n        img: \"/assets/img/moto-g5.jpg\",\r\n        description: \"Dispositivo móvil de Tienda e-commerce​\",\r\n        price: 9000\r\n    },\r\n    {\r\n        id: 5,\r\n        name: \"Motorola G4\",\r\n        img: \"/assets/img/moto-g4.jpg\",\r\n        description: \"Dispositivo móvil de Tienda e-commerce​\",\r\n        price: 8000\r\n    },\r\n    {\r\n        id: 6,\r\n        name: \"Sony Xperia XZ2\",\r\n        img: \"/assets/img/xperia.jpg\",\r\n        description: \"Dispositivo móvil de Tienda e-commerce​\",\r\n        price: 10000\r\n    }\r\n];\r\n"],"file":"app.js"}